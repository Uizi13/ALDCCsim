<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ALDCC simulator: src/solver.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen-custom.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ALDCC simulator<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">A program for analysis of linear direct current circuits.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('solver_8cpp.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">solver.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;array&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;ranges&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="util_8hpp_source.html">util.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="solver_8hpp_source.html">solver.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bisect_8hpp_source.html">bisect.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="constants_8hpp_source.html">constants.hpp</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adcc9c5478c69e59280620dafadeb1386" id="r_adcc9c5478c69e59280620dafadeb1386"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#adcc9c5478c69e59280620dafadeb1386">run</a> (<a class="el" href="struct_context.html">Context</a> &amp;ctx, bool do_bisection)</td></tr>
<tr class="memdesc:adcc9c5478c69e59280620dafadeb1386"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the main circuit analysis procedure.  <br /></td></tr>
<tr class="memitem:add061aa00c1922b96c1b48aafd8930b9" id="r_add061aa00c1922b96c1b48aafd8930b9"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#add061aa00c1922b96c1b48aafd8930b9">find_equations</a> (<a class="el" href="struct_context.html">Context</a> &amp;ctx)</td></tr>
<tr class="memdesc:add061aa00c1922b96c1b48aafd8930b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs the system of linear equations for the circuit using Modified Nodal Analysis (MNA).  <br /></td></tr>
<tr class="memitem:a984ba7dd12daeb0f03009e44cf38540e" id="r_a984ba7dd12daeb0f03009e44cf38540e"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#a984ba7dd12daeb0f03009e44cf38540e">solve</a> (<a class="el" href="struct_context.html">Context</a> &amp;ctx)</td></tr>
<tr class="memdesc:a984ba7dd12daeb0f03009e44cf38540e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the system of linear equations stored in the context using Gaussian elimination with partial pivoting.  <br /></td></tr>
<tr class="memitem:a35627a24cce6cb78a434199457c15dc0" id="r_a35627a24cce6cb78a434199457c15dc0"><td class="memItemLeft">std::pair&lt; std::vector&lt; double &gt;, std::vector&lt; double &gt; &gt;&#160;</td><td class="memItemRight"><a class="el" href="#a35627a24cce6cb78a434199457c15dc0">decode_and_normalize</a> (<a class="el" href="struct_context.html">Context</a> &amp;ctx)</td></tr>
<tr class="memdesc:a35627a24cce6cb78a434199457c15dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decodes the results from the reduced row echelon form of the equations.  <br /></td></tr>
<tr class="memitem:adb3f9b083d0f72a88d633a3ba7952e2a" id="r_adb3f9b083d0f72a88d633a3ba7952e2a"><td class="memItemLeft">void&#160;</td><td class="memItemRight"><a class="el" href="#adb3f9b083d0f72a88d633a3ba7952e2a">finalize</a> (<a class="el" href="struct_context.html">Context</a> &amp;ctx, const std::vector&lt; double &gt; &amp;potentials, const std::vector&lt; double &gt; &amp;currents)</td></tr>
<tr class="memdesc:adb3f9b083d0f72a88d633a3ba7952e2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates and updates the voltage, current, and power for every circuit element.  <br /></td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a35627a24cce6cb78a434199457c15dc0" name="a35627a24cce6cb78a434199457c15dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35627a24cce6cb78a434199457c15dc0">&#9670;&#160;</a></span>decode_and_normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; std::vector&lt; double &gt;, std::vector&lt; double &gt; &gt; decode_and_normalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_context.html">Context</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decodes the results from the reduced row echelon form of the equations. </p>
<p>Extracts the solved node potentials and voltage source currents from the matrix. It also checks for and handles rows representing identity and throws an error if the circuit is contradictory or not fully determinate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The Context object containing all circuit data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::pair&lt;std::vector&lt;double&gt;, std::vector&lt;double&gt;&gt; A pair of vectors: the first contains node potentials, the second contains voltage source currents. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_a35627a24cce6cb78a434199457c15dc0_cgraph.png" border="0" usemap="#asolver_8cpp_a35627a24cce6cb78a434199457c15dc0_cgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_a35627a24cce6cb78a434199457c15dc0_cgraph" id="asolver_8cpp_a35627a24cce6cb78a434199457c15dc0_cgraph">
<area shape="rect" title="Decodes the results from the reduced row echelon form of the equations." alt="" coords="5,5,160,32"/>
<area shape="rect" href="util_8cpp.html#ac86d2bb92cd5e73751e57b55efe25e4b" title="Initializes a vector of doubles with a specified number of zeros." alt="" coords="208,5,289,32"/>
<area shape="poly" title=" " alt="" coords="160,16,195,19,189,19,160,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_a35627a24cce6cb78a434199457c15dc0_icgraph.png" border="0" usemap="#asolver_8cpp_a35627a24cce6cb78a434199457c15dc0_icgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_a35627a24cce6cb78a434199457c15dc0_icgraph" id="asolver_8cpp_a35627a24cce6cb78a434199457c15dc0_icgraph">
<area shape="rect" title="Decodes the results from the reduced row echelon form of the equations." alt="" coords="479,57,633,83"/>
<area shape="rect" href="solver_8cpp.html#adcc9c5478c69e59280620dafadeb1386" title="Runs the main circuit analysis procedure." alt="" coords="391,57,431,83"/>
<area shape="poly" title=" " alt="" coords="460,70,431,73,431,67,466,70"/>
<area shape="rect" href="bisect_8cpp.html#a4cd34251e5ccdee020c25964d789f140" title="Implements the bisection method to find the variable element&#39;s value that yields the desired output v..." alt="" coords="103,57,159,83"/>
<area shape="poly" title=" " alt="" coords="383,46,365,33,342,22,305,11,275,8,245,12,208,22,175,38,148,58,145,54,172,34,206,17,244,7,275,3,306,6,344,17,368,29,389,46"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,107,55,134"/>
<area shape="poly" title=" " alt="" coords="389,93,368,112,344,123,304,134,263,140,181,143,108,137,55,128,55,123,109,132,181,137,262,135,303,129,342,118,365,107,384,95"/>
<area shape="rect" href="bisect_8cpp.html#a6caf972e3e9683cd9274703f425c07ef" title="Finds an initial search bound for the bisection method." alt="" coords="233,31,317,58"/>
<area shape="poly" title=" " alt="" coords="374,64,318,55,318,50,379,63"/>
<area shape="rect" href="bisect_8cpp.html#a3d9efdfe5fd52bd130e8ecfdf487d997" title="Determines the sign of the derivative of the output value with respect to the variable element value." alt="" coords="207,82,343,109"/>
<area shape="poly" title=" " alt="" coords="379,76,344,85,343,80,374,77"/>
<area shape="poly" title=" " alt="" coords="87,92,56,111,54,106,92,89"/>
<area shape="poly" title=" " alt="" coords="215,56,160,68,159,63,220,54"/>
<area shape="poly" title=" " alt="" coords="189,81,160,78,159,72,194,80"/>
</map>
</div>

</div>
</div>
<a id="adb3f9b083d0f72a88d633a3ba7952e2a" name="adb3f9b083d0f72a88d633a3ba7952e2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb3f9b083d0f72a88d633a3ba7952e2a">&#9670;&#160;</a></span>finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_context.html">Context</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>potentials</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>currents</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates and updates the voltage, current, and power for every circuit element. </p>
<p>Uses the solved node potentials and voltage source currents to determine the final operating parameters for all resistors, current sources, and voltage sources.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The Context object containing all circuit data. </td></tr>
    <tr><td class="paramname">potentials</td><td>A vector of solved node potentials. </td></tr>
    <tr><td class="paramname">currents</td><td>A vector of solved voltage source currents. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_adb3f9b083d0f72a88d633a3ba7952e2a_cgraph.png" border="0" usemap="#asolver_8cpp_adb3f9b083d0f72a88d633a3ba7952e2a_cgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_adb3f9b083d0f72a88d633a3ba7952e2a_cgraph" id="asolver_8cpp_adb3f9b083d0f72a88d633a3ba7952e2a_cgraph">
<area shape="rect" title="Calculates and updates the voltage, current, and power for every circuit element." alt="" coords="5,5,68,32"/>
<area shape="rect" href="util_8cpp.html#a4df3bd8d21b99bf5053e033b9ff2809d" title="Creates a unique 16&#45;bit key for a node pair, independent of the order." alt="" coords="116,5,193,32"/>
<area shape="poly" title=" " alt="" coords="68,16,103,18,97,19,68,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_adb3f9b083d0f72a88d633a3ba7952e2a_icgraph.png" border="0" usemap="#asolver_8cpp_adb3f9b083d0f72a88d633a3ba7952e2a_icgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_adb3f9b083d0f72a88d633a3ba7952e2a_icgraph" id="asolver_8cpp_adb3f9b083d0f72a88d633a3ba7952e2a_icgraph">
<area shape="rect" title="Calculates and updates the voltage, current, and power for every circuit element." alt="" coords="479,57,541,83"/>
<area shape="rect" href="solver_8cpp.html#adcc9c5478c69e59280620dafadeb1386" title="Runs the main circuit analysis procedure." alt="" coords="391,57,431,83"/>
<area shape="poly" title=" " alt="" coords="460,70,431,73,431,67,466,70"/>
<area shape="rect" href="bisect_8cpp.html#a4cd34251e5ccdee020c25964d789f140" title="Implements the bisection method to find the variable element&#39;s value that yields the desired output v..." alt="" coords="103,57,159,83"/>
<area shape="poly" title=" " alt="" coords="383,46,365,33,342,22,305,11,275,8,245,12,208,22,175,38,148,58,145,54,172,34,206,17,244,7,275,3,306,6,344,17,368,29,389,46"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,107,55,134"/>
<area shape="poly" title=" " alt="" coords="389,93,368,112,344,123,304,134,263,140,181,143,108,137,55,128,55,123,109,132,181,137,262,135,303,129,342,118,365,107,384,95"/>
<area shape="rect" href="bisect_8cpp.html#a6caf972e3e9683cd9274703f425c07ef" title="Finds an initial search bound for the bisection method." alt="" coords="233,31,317,58"/>
<area shape="poly" title=" " alt="" coords="374,64,318,55,318,50,379,63"/>
<area shape="rect" href="bisect_8cpp.html#a3d9efdfe5fd52bd130e8ecfdf487d997" title="Determines the sign of the derivative of the output value with respect to the variable element value." alt="" coords="207,82,343,109"/>
<area shape="poly" title=" " alt="" coords="379,76,344,85,343,80,374,77"/>
<area shape="poly" title=" " alt="" coords="87,92,56,111,54,106,92,89"/>
<area shape="poly" title=" " alt="" coords="215,56,160,68,159,63,220,54"/>
<area shape="poly" title=" " alt="" coords="189,81,160,78,159,72,194,80"/>
</map>
</div>

</div>
</div>
<a id="add061aa00c1922b96c1b48aafd8930b9" name="add061aa00c1922b96c1b48aafd8930b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add061aa00c1922b96c1b48aafd8930b9">&#9670;&#160;</a></span>find_equations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void find_equations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_context.html">Context</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructs the system of linear equations for the circuit using Modified Nodal Analysis (MNA). </p>
<p>This function creates equations based on:</p><ol type="1">
<li>Ground node (Node 1) potential is zero.</li>
<li>Voltage sources (introducing a new unknown for every voltage source current).</li>
<li>Kirchhoff's Current Law (KCL) for every non-ground node.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The Context object containing all circuit data. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_add061aa00c1922b96c1b48aafd8930b9_cgraph.png" border="0" usemap="#asolver_8cpp_add061aa00c1922b96c1b48aafd8930b9_cgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_add061aa00c1922b96c1b48aafd8930b9_cgraph" id="asolver_8cpp_add061aa00c1922b96c1b48aafd8930b9_cgraph">
<area shape="rect" title="Constructs the system of linear equations for the circuit using Modified Nodal Analysis (MNA)." alt="" coords="5,35,111,61"/>
<area shape="rect" href="util_8cpp.html#ac86d2bb92cd5e73751e57b55efe25e4b" title="Initializes a vector of doubles with a specified number of zeros." alt="" coords="341,5,422,32"/>
<area shape="poly" title=" " alt="" coords="91,32,123,20,158,12,246,6,328,11,323,13,246,11,159,17,125,26,93,37"/>
<area shape="rect" href="util_8cpp.html#a952920f329fea356a71390fcffe13816" title="Inserts the equation for the ground node (Node 1) into the system." alt="" coords="159,27,293,69"/>
<area shape="poly" title=" " alt="" coords="111,45,146,47,141,49,112,51"/>
<area shape="rect" href="util_8cpp.html#a4df3bd8d21b99bf5053e033b9ff2809d" title="Creates a unique 16&#45;bit key for a node pair, independent of the order." alt="" coords="187,93,264,120"/>
<area shape="poly" title=" " alt="" coords="99,59,175,87,170,89,98,65"/>
<area shape="poly" title=" " alt="" coords="293,33,328,28,323,30,294,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_add061aa00c1922b96c1b48aafd8930b9_icgraph.png" border="0" usemap="#asolver_8cpp_add061aa00c1922b96c1b48aafd8930b9_icgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_add061aa00c1922b96c1b48aafd8930b9_icgraph" id="asolver_8cpp_add061aa00c1922b96c1b48aafd8930b9_icgraph">
<area shape="rect" title="Constructs the system of linear equations for the circuit using Modified Nodal Analysis (MNA)." alt="" coords="479,57,584,83"/>
<area shape="rect" href="solver_8cpp.html#adcc9c5478c69e59280620dafadeb1386" title="Runs the main circuit analysis procedure." alt="" coords="391,57,431,83"/>
<area shape="poly" title=" " alt="" coords="460,70,431,73,431,67,466,70"/>
<area shape="rect" href="bisect_8cpp.html#a4cd34251e5ccdee020c25964d789f140" title="Implements the bisection method to find the variable element&#39;s value that yields the desired output v..." alt="" coords="103,57,159,83"/>
<area shape="poly" title=" " alt="" coords="383,46,365,33,342,22,305,11,275,8,245,12,208,22,175,38,148,58,145,54,172,34,206,17,244,7,275,3,306,6,344,17,368,29,389,46"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,107,55,134"/>
<area shape="poly" title=" " alt="" coords="389,93,368,112,344,123,304,134,263,140,181,143,108,137,55,128,55,123,109,132,181,137,262,135,303,129,342,118,365,107,384,95"/>
<area shape="rect" href="bisect_8cpp.html#a6caf972e3e9683cd9274703f425c07ef" title="Finds an initial search bound for the bisection method." alt="" coords="233,31,317,58"/>
<area shape="poly" title=" " alt="" coords="374,64,318,55,318,50,379,63"/>
<area shape="rect" href="bisect_8cpp.html#a3d9efdfe5fd52bd130e8ecfdf487d997" title="Determines the sign of the derivative of the output value with respect to the variable element value." alt="" coords="207,82,343,109"/>
<area shape="poly" title=" " alt="" coords="379,76,344,85,343,80,374,77"/>
<area shape="poly" title=" " alt="" coords="87,92,56,111,54,106,92,89"/>
<area shape="poly" title=" " alt="" coords="215,56,160,68,159,63,220,54"/>
<area shape="poly" title=" " alt="" coords="189,81,160,78,159,72,194,80"/>
</map>
</div>

</div>
</div>
<a id="adcc9c5478c69e59280620dafadeb1386" name="adcc9c5478c69e59280620dafadeb1386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcc9c5478c69e59280620dafadeb1386">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_context.html">Context</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>do_bisection</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the main circuit analysis procedure. </p>
<p>Finds all necessary nodal and source equations, solves the resulting system of linear equations and decodes the results into node potentials and source currents. If bisection is enabled, it updates the output value for the bisection algorithm.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The Context object containing all circuit data. </td></tr>
    <tr><td class="paramname">do_bisection</td><td>Boolean flag indicating whether to perform bisection updates. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_adcc9c5478c69e59280620dafadeb1386_cgraph.png" border="0" usemap="#asolver_8cpp_adcc9c5478c69e59280620dafadeb1386_cgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_adcc9c5478c69e59280620dafadeb1386_cgraph" id="asolver_8cpp_adcc9c5478c69e59280620dafadeb1386_cgraph">
<area shape="rect" title="Runs the main circuit analysis procedure." alt="" coords="5,107,45,133"/>
<area shape="rect" href="solver_8cpp.html#a35627a24cce6cb78a434199457c15dc0" title="Decodes the results from the reduced row echelon form of the equations." alt="" coords="303,5,457,32"/>
<area shape="poly" title=" " alt="" coords="31,105,55,72,72,55,91,42,139,23,190,12,241,7,290,9,285,11,241,13,191,17,141,28,94,46,75,59,59,76,36,108"/>
<area shape="rect" href="solver_8cpp.html#adb3f9b083d0f72a88d633a3ba7952e2a" title="Calculates and updates the voltage, current, and power for every circuit element." alt="" coords="143,56,205,83"/>
<area shape="poly" title=" " alt="" coords="43,110,92,92,130,81,126,85,94,97,46,115"/>
<area shape="rect" href="solver_8cpp.html#add061aa00c1922b96c1b48aafd8930b9" title="Constructs the system of linear equations for the circuit using Modified Nodal Analysis (MNA)." alt="" coords="121,107,226,133"/>
<area shape="poly" title=" " alt="" coords="44,117,107,118,104,122,46,123"/>
<area shape="rect" href="solver_8cpp.html#a984ba7dd12daeb0f03009e44cf38540e" title="Solves the system of linear equations stored in the context using Gaussian elimination with partial p..." alt="" coords="148,157,200,184"/>
<area shape="poly" title=" " alt="" coords="45,125,94,143,135,158,130,160,92,148,45,130"/>
<area shape="rect" href="bisect_8cpp.html#a7547c18d4e250b1715268f3e86d42892" title="Updates the output value for the bisection algorithm." alt="" coords="93,208,255,235"/>
<area shape="poly" title=" " alt="" coords="36,131,61,163,94,194,104,201,99,201,91,198,57,167,34,136"/>
<area shape="rect" href="util_8cpp.html#ac86d2bb92cd5e73751e57b55efe25e4b" title="Initializes a vector of doubles with a specified number of zeros." alt="" coords="505,107,587,133"/>
<area shape="poly" title=" " alt="" coords="433,30,459,42,494,67,525,96,519,95,491,71,456,46,432,35"/>
<area shape="rect" href="util_8cpp.html#a4df3bd8d21b99bf5053e033b9ff2809d" title="Creates a unique 16&#45;bit key for a node pair, independent of the order." alt="" coords="342,56,419,83"/>
<area shape="poly" title=" " alt="" coords="205,67,328,68,324,71,206,72"/>
<area shape="poly" title=" " alt="" coords="227,117,492,118,488,122,227,123"/>
<area shape="poly" title=" " alt="" coords="226,105,329,81,324,84,228,110"/>
<area shape="rect" href="util_8cpp.html#a952920f329fea356a71390fcffe13816" title="Inserts the equation for the ground node (Node 1) into the system." alt="" coords="313,157,447,200"/>
<area shape="poly" title=" " alt="" coords="224,131,300,155,295,156,223,137"/>
<area shape="poly" title=" " alt="" coords="442,154,489,140,495,138,443,159"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_adcc9c5478c69e59280620dafadeb1386_icgraph.png" border="0" usemap="#asolver_8cpp_adcc9c5478c69e59280620dafadeb1386_icgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_adcc9c5478c69e59280620dafadeb1386_icgraph" id="asolver_8cpp_adcc9c5478c69e59280620dafadeb1386_icgraph">
<area shape="rect" title="Runs the main circuit analysis procedure." alt="" coords="391,57,431,83"/>
<area shape="rect" href="bisect_8cpp.html#a4cd34251e5ccdee020c25964d789f140" title="Implements the bisection method to find the variable element&#39;s value that yields the desired output v..." alt="" coords="103,57,159,83"/>
<area shape="poly" title=" " alt="" coords="383,46,365,33,342,22,305,11,275,8,245,12,208,22,175,38,148,58,145,54,172,34,206,17,244,7,275,3,306,6,344,17,368,29,389,46"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,107,55,134"/>
<area shape="poly" title=" " alt="" coords="389,93,368,112,344,123,304,134,263,140,181,143,108,137,55,128,55,123,109,132,181,137,262,135,303,129,342,118,365,107,384,95"/>
<area shape="rect" href="bisect_8cpp.html#a6caf972e3e9683cd9274703f425c07ef" title="Finds an initial search bound for the bisection method." alt="" coords="233,31,317,58"/>
<area shape="poly" title=" " alt="" coords="374,64,318,55,318,50,379,63"/>
<area shape="rect" href="bisect_8cpp.html#a3d9efdfe5fd52bd130e8ecfdf487d997" title="Determines the sign of the derivative of the output value with respect to the variable element value." alt="" coords="207,82,343,109"/>
<area shape="poly" title=" " alt="" coords="379,76,344,85,343,80,374,77"/>
<area shape="poly" title=" " alt="" coords="87,92,56,111,54,106,92,89"/>
<area shape="poly" title=" " alt="" coords="215,56,160,68,159,63,220,54"/>
<area shape="poly" title=" " alt="" coords="189,81,160,78,159,72,194,80"/>
</map>
</div>

</div>
</div>
<a id="a984ba7dd12daeb0f03009e44cf38540e" name="a984ba7dd12daeb0f03009e44cf38540e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a984ba7dd12daeb0f03009e44cf38540e">&#9670;&#160;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_context.html">Context</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>ctx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the system of linear equations stored in the context using Gaussian elimination with partial pivoting. </p>
<p>The equations are represented as an augmented matrix stored in <span class="tt">ctx.equations</span>. After solving, the matrix is in reduced row echelon form. Throws a std::runtime_error if contradictory equations are found.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The Context object containing all circuit data. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="solver_8cpp_a984ba7dd12daeb0f03009e44cf38540e_icgraph.png" border="0" usemap="#asolver_8cpp_a984ba7dd12daeb0f03009e44cf38540e_icgraph" loading="lazy" alt=""/></div>
<map name="asolver_8cpp_a984ba7dd12daeb0f03009e44cf38540e_icgraph" id="asolver_8cpp_a984ba7dd12daeb0f03009e44cf38540e_icgraph">
<area shape="rect" title="Solves the system of linear equations stored in the context using Gaussian elimination with partial p..." alt="" coords="479,57,531,83"/>
<area shape="rect" href="solver_8cpp.html#adcc9c5478c69e59280620dafadeb1386" title="Runs the main circuit analysis procedure." alt="" coords="391,57,431,83"/>
<area shape="poly" title=" " alt="" coords="460,70,431,73,431,67,466,70"/>
<area shape="rect" href="bisect_8cpp.html#a4cd34251e5ccdee020c25964d789f140" title="Implements the bisection method to find the variable element&#39;s value that yields the desired output v..." alt="" coords="103,57,159,83"/>
<area shape="poly" title=" " alt="" coords="383,46,365,33,342,22,305,11,275,8,245,12,208,22,175,38,148,58,145,54,172,34,206,17,244,7,275,3,306,6,344,17,368,29,389,46"/>
<area shape="rect" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,107,55,134"/>
<area shape="poly" title=" " alt="" coords="389,93,368,112,344,123,304,134,263,140,181,143,108,137,55,128,55,123,109,132,181,137,262,135,303,129,342,118,365,107,384,95"/>
<area shape="rect" href="bisect_8cpp.html#a6caf972e3e9683cd9274703f425c07ef" title="Finds an initial search bound for the bisection method." alt="" coords="233,31,317,58"/>
<area shape="poly" title=" " alt="" coords="374,64,318,55,318,50,379,63"/>
<area shape="rect" href="bisect_8cpp.html#a3d9efdfe5fd52bd130e8ecfdf487d997" title="Determines the sign of the derivative of the output value with respect to the variable element value." alt="" coords="207,82,343,109"/>
<area shape="poly" title=" " alt="" coords="379,76,344,85,343,80,374,77"/>
<area shape="poly" title=" " alt="" coords="87,92,56,111,54,106,92,89"/>
<area shape="poly" title=" " alt="" coords="215,56,160,68,159,63,220,54"/>
<area shape="poly" title=" " alt="" coords="189,81,160,78,159,72,194,80"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="solver_8cpp.html">solver.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
